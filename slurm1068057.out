0
[2025-12-17 20:44:36,858::train::INFO] Namespace(config='configs/tuning_0_0.yml', device='cuda', logdir='./logs_diffusion', tag='', train_report_iter=200)
[2025-12-17 20:44:36,859::train::INFO] {'data': {'name': 'pl', 'path': './data/crossdocked_v1.1_rmsd1.0_pocket10', 'split': './data/crossdocked_pocket10_pose_split.pt', 'transform': {'ligand_atom_mode': 'add_aromatic', 'random_rot': False}}, 'model': {'model_mean_type': 'C0', 'beta_schedule': 'sigmoid', 'beta_start': 1e-07, 'beta_end': 0.002, 'v_beta_schedule': 'cosine', 'v_beta_s': 0.01, 'num_diffusion_timesteps': 1000, 'loss_v_weight': 100.0, 'sample_time_method': 'symmetric', 'time_emb_dim': 0, 'time_emb_mode': 'simple', 'center_pos_mode': 'protein', 'node_indicator': True, 'model_type': 'uni_o2', 'num_blocks': 1, 'num_layers': 9, 'hidden_dim': 128, 'n_heads': 16, 'edge_feat_dim': 4, 'num_r_gaussian': 20, 'knn': 32, 'num_node_types': 8, 'act_fn': 'relu', 'norm': True, 'cutoff_mode': 'knn', 'ew_net_type': 'global', 'num_x2h': 1, 'num_h2x': 1, 'r_max': 10.0, 'x2h_out_fc': False, 'sync_twoup': False, 'compactness_weight': 0.0, 'spp_weight': 0.0}, 'train': {'seed': 2021, 'batch_size': 4, 'num_workers': 4, 'n_acc_batch': 1, 'max_iters': 100000, 'val_freq': 2000, 'pos_noise_std': 0.1, 'max_grad_norm': 8.0, 'bond_loss_weight': 1.0, 'optimizer': {'type': 'adam', 'lr': 0.001, 'weight_decay': 0, 'beta1': 0.95, 'beta2': 0.999}, 'scheduler': {'type': 'plateau', 'factor': 0.6, 'patience': 10, 'min_lr': 1e-06}}}
[2025-12-17 20:44:36,899::train::INFO] Loading dataset...
[2025-12-17 20:44:36,971::train::INFO] Training: 91712 Validation: 89
[2025-12-17 20:44:36,972::train::INFO] Building model...
[2025-12-17 20:44:37,971::train::INFO] # trainable parameters: 2.8247 M
[2025-12-17 20:44:37,971::train::INFO] Model hyperparams: loss_v_weight=100.000, spp_weight=0.000, compactness_weight=0.000
protein feature dim: 27 ligand feature dim: 13
[2025-12-17 20:45:08,939::train::INFO] [Train] Iter 00200 | Loss 1.586861 | Loss pos 1.395641 | Loss v 0.001912 | Compact 5.574354 | SPP 0.000000 | Energy 0.454614 | Grad 6.1265 | LR 0.001000
[2025-12-17 20:45:38,304::train::INFO] [Train] Iter 00400 | Loss 0.936752 | Loss pos 0.853912 | Loss v 0.000828 | Compact 11.371302 | SPP 0.000000 | Energy 0.814177 | Grad 2.3136 | LR 0.001000
[2025-12-17 20:46:08,266::train::INFO] [Train] Iter 00600 | Loss 1.106935 | Loss pos 0.990694 | Loss v 0.001162 | Compact 9.755168 | SPP 0.000000 | Energy 1.070814 | Grad 1.7588 | LR 0.001000
[2025-12-17 20:46:37,995::train::INFO] [Train] Iter 00800 | Loss 0.645129 | Loss pos 0.470750 | Loss v 0.001744 | Compact 9.163874 | SPP 0.000000 | Energy 0.788651 | Grad 0.6929 | LR 0.001000
[2025-12-17 20:47:07,750::train::INFO] [Train] Iter 01000 | Loss 0.522560 | Loss pos 0.400934 | Loss v 0.001216 | Compact 10.326637 | SPP 0.000000 | Energy 0.722041 | Grad 0.7491 | LR 0.001000
[2025-12-17 20:47:37,047::train::INFO] [Train] Iter 01200 | Loss 0.739200 | Loss pos 0.665927 | Loss v 0.000733 | Compact 5.360819 | SPP 0.000000 | Energy 0.761483 | Grad 0.6233 | LR 0.001000
[2025-12-17 20:48:06,700::train::INFO] [Train] Iter 01400 | Loss 0.324510 | Loss pos 0.234256 | Loss v 0.000903 | Compact 13.847889 | SPP 0.000000 | Energy 0.943264 | Grad 0.2180 | LR 0.001000
[2025-12-17 20:48:36,276::train::INFO] [Train] Iter 01600 | Loss 0.373891 | Loss pos 0.346894 | Loss v 0.000270 | Compact 8.854544 | SPP 0.000000 | Energy 0.895539 | Grad 0.3162 | LR 0.001000
[2025-12-17 20:49:06,232::train::INFO] [Train] Iter 01800 | Loss 1.441638 | Loss pos 1.346559 | Loss v 0.000951 | Compact 2.881030 | SPP 0.000000 | Energy 1.202568 | Grad 0.8242 | LR 0.001000
[2025-12-17 20:49:36,054::train::INFO] [Train] Iter 02000 | Loss 1.007572 | Loss pos 0.817760 | Loss v 0.001898 | Compact 6.559811 | SPP 0.000000 | Energy 0.976314 | Grad 1.7252 | LR 0.001000
Validate:   0%|          | 0/23 [00:00<?, ?it/s]Validate:   4%|▍         | 1/23 [00:00<00:06,  3.42it/s]Validate:   9%|▊         | 2/23 [00:00<00:07,  2.98it/s]Validate:  13%|█▎        | 3/23 [00:01<00:07,  2.52it/s]Validate:  17%|█▋        | 4/23 [00:01<00:09,  2.02it/s]Validate:  22%|██▏       | 5/23 [00:02<00:08,  2.05it/s]Validate:  26%|██▌       | 6/23 [00:02<00:08,  1.98it/s]Validate:  30%|███       | 7/23 [00:03<00:08,  1.97it/s]Validate:  35%|███▍      | 8/23 [00:03<00:06,  2.15it/s]Validate:  39%|███▉      | 9/23 [00:04<00:06,  2.33it/s]Validate:  43%|████▎     | 10/23 [00:04<00:06,  2.01it/s]Validate:  48%|████▊     | 11/23 [00:05<00:05,  2.13it/s]Validate:  52%|█████▏    | 12/23 [00:05<00:05,  2.12it/s]Validate:  57%|█████▋    | 13/23 [00:06<00:04,  2.08it/s]Validate:  61%|██████    | 14/23 [00:06<00:04,  2.05it/s]Validate:  65%|██████▌   | 15/23 [00:07<00:03,  2.00it/s]Validate:  70%|██████▉   | 16/23 [00:07<00:03,  1.96it/s]Validate:  74%|███████▍  | 17/23 [00:08<00:03,  1.92it/s]Validate:  78%|███████▊  | 18/23 [00:08<00:02,  1.99it/s]Validate:  83%|████████▎ | 19/23 [00:09<00:01,  2.16it/s]Validate:  87%|████████▋ | 20/23 [00:09<00:01,  2.23it/s]Validate:  91%|█████████▏| 21/23 [00:09<00:00,  2.23it/s]Validate:  96%|█████████▌| 22/23 [00:10<00:00,  2.15it/s]Validate: 100%|██████████| 23/23 [00:10<00:00,  2.67it/s]Validate: 100%|██████████| 23/23 [00:10<00:00,  2.18it/s]
[2025-12-17 20:49:46,664::train::INFO] [Validate] Iter 02000 | Loss 0.964423 | Loss pos 0.877943 | Loss v 0.864793 e-3 | Avg atom auroc 0.868672 | Compact 8.408905 | SPP 0.000000
Traceback (most recent call last):
  File "/mnt/data1/users/andrij/conda/envs/tagmol/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/mnt/data1/users/andrij/conda/envs/tagmol/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/mnt/scratch/users/andrij/PMODiff/scripts/train_diffusion.py", line 261, in <module>
    logger.info(f'[Validate] Best val loss achieved: {val_loss:.6f}')
TypeError: unsupported format string passed to NoneType.__format__
atom: (1, False) 	 auc roc: 0.9170
atom: (6, False) 	 auc roc: 0.8627
atom: (6, True) 	 auc roc: 0.9067
atom: (7, False) 	 auc roc: 0.7584
atom: (7, True) 	 auc roc: 0.7963
atom: (8, False) 	 auc roc: 0.8653
atom: (8, True) 	 auc roc: 0.7581
atom: (9, False) 	 auc roc: 0.8670
atom: (15, False) 	 auc roc: 0.9420
atom: (16, False) 	 auc roc: 0.7089
atom: (16, True) 	 auc roc: 0.7474
atom: (17, False) 	 auc roc: 0.9438
