0
[2025-12-09 10:01:41,499::train::INFO] Namespace(config='configs/tuning_0_0.yml', device='cuda', logdir='./logs_diffusion', tag='', train_report_iter=200)
[2025-12-09 10:01:41,501::train::INFO] {'data': {'name': 'pl', 'path': './data/crossdocked_v1.1_rmsd1.0_pocket10', 'split': './data/crossdocked_pocket10_pose_split.pt', 'transform': {'ligand_atom_mode': 'add_aromatic', 'random_rot': False}}, 'model': {'model_mean_type': 'C0', 'beta_schedule': 'sigmoid', 'beta_start': 1e-07, 'beta_end': 0.002, 'v_beta_schedule': 'cosine', 'v_beta_s': 0.01, 'num_diffusion_timesteps': 1000, 'loss_v_weight': 100.0, 'sample_time_method': 'symmetric', 'time_emb_dim': 0, 'time_emb_mode': 'simple', 'center_pos_mode': 'protein', 'node_indicator': True, 'model_type': 'uni_o2', 'num_blocks': 1, 'num_layers': 9, 'hidden_dim': 128, 'n_heads': 16, 'edge_feat_dim': 4, 'num_r_gaussian': 20, 'knn': 32, 'num_node_types': 8, 'act_fn': 'relu', 'norm': True, 'cutoff_mode': 'knn', 'ew_net_type': 'global', 'num_x2h': 1, 'num_h2x': 1, 'r_max': 10.0, 'x2h_out_fc': False, 'sync_twoup': False, 'compactness_weight': 0.0, 'spp_weight': 0.0}, 'train': {'seed': 2021, 'batch_size': 4, 'num_workers': 4, 'n_acc_batch': 1, 'max_iters': 100000, 'val_freq': 2000, 'pos_noise_std': 0.1, 'max_grad_norm': 8.0, 'bond_loss_weight': 1.0, 'optimizer': {'type': 'adam', 'lr': 0.001, 'weight_decay': 0, 'beta1': 0.95, 'beta2': 0.999}, 'scheduler': {'type': 'plateau', 'factor': 0.6, 'patience': 10, 'min_lr': 1e-06}}}
[2025-12-09 10:01:41,645::train::INFO] Loading dataset...
[2025-12-09 10:01:41,699::train::INFO] Training: 99990 Validation: 100
[2025-12-09 10:01:41,699::train::INFO] Building model...
[2025-12-09 10:01:51,113::train::INFO] # trainable parameters: 2.8247 M
[2025-12-09 10:01:51,114::train::INFO] Model hyperparams: loss_v_weight=100.000, spp_weight=0.000, compactness_weight=0.000
protein feature dim: 27 ligand feature dim: 13
Traceback (most recent call last):
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/mnt/scratch/users/andrij/PMODiff/scripts/train_diffusion.py", line 256, in <module>
    train(it)
  File "/mnt/scratch/users/andrij/PMODiff/scripts/train_diffusion.py", line 128, in train
    batch = next(train_iterator).to(args.device)
  File "/mnt/scratch/users/andrij/PMODiff/utils/train.py", line 50, in inf_iterator
    yield iterator.__next__()
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/users/andrij/scratch/miniconda3/envs/tagmol/lib/python3.8/site-packages/torch/utils/data/dataset.py", line 295, in __getitem__
    return self.dataset[self.indices[idx]]
  File "/mnt/scratch/users/andrij/PMODiff/datasets/pl_pair_dataset.py", line 105, in __getitem__
    data = self.get_ori_data(idx)
  File "/mnt/scratch/users/andrij/PMODiff/datasets/pl_pair_dataset.py", line 113, in get_ori_data
    key = self.keys[idx]
IndexError: list index out of range

